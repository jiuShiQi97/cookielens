# 🔧 CookieLens 调试指南

## 问题诊断

如果你看到"一直在analysis"的问题，这通常是由以下几个原因造成的：

### 1. CORS (跨域) 问题
浏览器扩展尝试访问Lambda API时被CORS策略阻止。

### 2. 网络连接问题
无法访问Lambda API端点。

### 3. 扩展加载问题
浏览器扩展没有正确加载或运行。

## 🧪 调试步骤

### 步骤1: 使用调试页面
1. 打开 `debug-test.html` 文件
2. 点击 "Test Direct API Call" 按钮
3. 查看是否能成功调用API

### 步骤2: 检查浏览器控制台
1. 按 F12 打开开发者工具
2. 查看 Console 标签页
3. 寻找 CookieLens 相关的日志
4. 查看是否有错误信息

### 步骤3: 检查网络请求
1. 在开发者工具中点击 Network 标签页
2. 尝试分析网站
3. 查看是否有对Lambda API的请求
4. 检查请求状态和响应

### 步骤4: 验证扩展安装
1. 打开 `chrome://extensions/`
2. 确认 CookieLens 扩展已启用
3. 检查是否有错误信息
4. 重新加载扩展

## 🔍 调试版本功能

我已经创建了一个调试版本的扩展 (`content-debug.js`)，它包含：

- ✅ **API连接测试按钮**: 直接测试Lambda API连接
- ✅ **详细调试信息**: 显示当前URL、API端点等
- ✅ **控制台日志**: 详细的日志输出
- ✅ **错误处理**: 更好的错误显示
- ✅ **简化结果**: 更容易查看的分析结果

## 🚀 快速修复

### 如果API调用失败：
1. 检查网络连接
2. 确认Lambda API端点可访问
3. 检查CORS设置

### 如果扩展不工作：
1. 重新加载扩展
2. 检查manifest.json权限
3. 查看控制台错误

### 如果一直显示"Analyzing..."：
1. 检查网络请求是否超时
2. 查看Lambda函数日志
3. 确认API响应格式正确

## 📊 测试结果

根据我们的测试，Lambda API是正常工作的：
- ✅ GitHub: 1个Cookie，24个第三方服务
- ✅ 百度: 1个Cookie，40个第三方服务
- ✅ 响应时间: 0.5-2.5秒

## 🎯 下一步

1. **使用调试页面**: 打开 `debug-test.html` 测试API
2. **检查控制台**: 查看详细的错误信息
3. **重新安装扩展**: 使用调试版本
4. **报告问题**: 告诉我具体的错误信息

## 💡 常见解决方案

### 方案1: 重新安装扩展
1. 在 `chrome://extensions/` 中删除扩展
2. 重新加载 `frontend` 文件夹
3. 刷新测试页面

### 方案2: 检查网络
1. 确认能访问 `https://kr9knqhdha.execute-api.us-east-1.amazonaws.com`
2. 检查防火墙设置
3. 尝试不同的网络环境

### 方案3: 使用调试版本
1. 确保使用 `content-debug.js`
2. 点击 "Test API Connection" 按钮
3. 查看详细的调试信息

## 📞 获取帮助

如果问题仍然存在，请提供：
1. 浏览器控制台的错误信息
2. 网络请求的状态
3. 扩展的加载状态
4. 具体的错误描述

这样我就能帮你快速定位和解决问题！
